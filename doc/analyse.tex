%%% Dokumentenklasse und Layout 
\documentclass[fontsize=12pt,a4paper,headinclude=no,headings=small]{scrartcl}

%%% Ränder
%\usepackage{typearea}
\areaset{180mm}{230mm} % Der gewünschte Satzspiegel

%%% Sprache, Rechtschreibung, Silbentrennung
\usepackage[ngerman]{babel} 	% Deutscher Text
\usepackage[T1]{fontenc}			% Trennung von Umlauten enthaltenden Woertern
\usepackage[utf8x]{inputenc} 	% Erlaubt Eingabe von Umlauten (kein "a etc. notwendig). 
\usepackage[right]{eurosym}		% Euro-Symbol verwendbar (durch \euro)

%%% Darstellung, Formatierung
\addtokomafont{sectioning}{\rmfamily} 	% Serifen in Überschrift
\clubpenalty = 1000 			% reduziert Schusterjungen
\widowpenalty = 1000 			% reduziert Hurenkinder
%\usepackage{ae,aecompl}			% schönere Schriftart (Vektorfonts)

%%% Links für pdflatex
\usepackage{hyperref}	% PDF Referenzen klickbar
\usepackage{url}		% URLs klickbar

%%% Tabellen und Grafiken, Listen
\usepackage{graphicx}	% Grafiken einbinden
\usepackage{pdfpages}		% PDFs einbinden
\usepackage{float}
\usepackage{tabularx}
\usepackage{dcolumn}
\usepackage{multicol}
%\setlength{\columnseprule}{1pt}
%\setlength{\columnsep}{10pt}
\newcolumntype{C}{>{\centering\arraybackslash}X}
\newcolumntype{R}{>{\arraybackslash}X}
%\usepackage[skip=0pt,labelfont=it,nooneline,hang,small]{caption}
\usepackage{enumerate}

%%% Punkt + Komma Abstände bei Tausendern/Dezimalzahlen ans dt. anpassen
%\mathcode`,="013B
%\mathcode`.="613A

%%% Farben (Farben siehe: http://en.wikibooks.org/wiki/LaTeX/Colors)
\usepackage{color}

%%% TikZ
\usepackage{pgf}
\usepackage{tikz}
\usetikzlibrary{arrows,automata}

%%% Mathe
\usepackage[fleqn]{amsmath}
\usepackage{amssymb}
\usepackage{amsthm} % Umgebung für Beweise und Theoreme
%\usepackage{amsfonts}
\allowdisplaybreaks % Alignment Umgebung darf auf mehrere Seiten umbrechen
\usepackage{dsfont}

%%% Header
\usepackage{fancyhdr}
\pagestyle{fancy}
\setlength{\headheight}{30pt}
\lhead{Hausaufgabe zur Vorlesung \\\emph{Mobile und verteilte Datenbanken}}
\rhead{Dennis Krüger ()\\Martin Thurau (612016)}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\chead{}

%%% eigene Befehle
\newcommand{\footurl}[1]{\footnote{\url{#1}}}
% TODO und FIXME
  \newcommand{\todo}[1]{\colorbox{yellow}{\textbf{TODO} #1}}
  \newcommand{\fixme}[1]{\colorbox{red}{\textbf{FIXME} #1}}
% Sequenz
  \newcommand{\seq}[1]{\ensuremath{\left \langle #1 \right \rangle }}
% Mengen (mit und ohne "`für die gilt"' Bedingung
  \newcommand{\set}[1]{\ensuremath{\left\lbrace {#1} \right\rbrace }}
  \newcommand{\condset}[2]{\ensuremath{\left\lbrace #1 \;\middle|\; #2 \right\rbrace }}

%%% Mathe Operatorentype filter text
\renewcommand{\div}{\ensuremath{\text{ div }}}
\renewcommand{\mod}{\ensuremath{\text{ mod }}}
\DeclareMathOperator{\ef}{emptyfile}
\DeclareMathOperator{\es}{empty}

\begin{document}

\section{Verteiltes Sortieren}
\subsection{Umgebung}
Um das verteilte Sortieren sinnvoll Testen zu könne, ist es notwendig die Ausführung auf mehrere Rechner zu verteilen. Eine rein lokale Ausführung würde zum einen keinen realistischen Kommunikationoverhead bedeuten, zum anderen wäre die Ausführung an die Leistungsfähigkeit der lokalen CPU gebunden.

Die Messreihen wurden daher auf virtuellen Maschinen in der Amazon Elastic Compute Cloud (Amazon EC2)\footurl{http://aws.amazon.com/ec2/} ausgeführt. Die Ausführung erfolgte dabei jeweils für Server und jeden Client getrennt auf einer eigenen "`Micro"' Instanz. Zur Durchführung der Testreihen wurde mit Hilfe von Python, Fabric\footurl{http://fabfile.org} und boto\footurl{http://code.google.com/p/boto/} automatisiert und ausgeführt.

\subsection{Durchführung der Messung}
Die Performancemessung wird ausschließlich auf dem Server durchgeführt. Der Server misst dabei, wie viele Millisekunden er für das einlesen der zu sortierenden Daten, zum verteilen der Daten an die Clients sowie zum Interieren über die Sortierten Ergebnisse benötigt. Außerdem wird noch die gesamte Ausführugnszeit gemessen. Da es sich bei der Umgebung, in der das Sortieren durchgeführt wird, um virtuelle Maschinen handelt, ist die Ausführungszeit natürlich abhängig von der Auslastung der physikalischen Hosts. Es ist jedoch davon auszugehen, dass aufgrund der Tatsache, das Amazon die Instanzen über viele Rechner verteilt, ein brauchbarer Mittelwert entsteht.

\subsection{Parameter der Messungen}
Die Messreihen wurden jeweils mit 2, 4, 8 und 16 Sortierclients und einem Server durchgeführt. Dabei wurden jeweils die Blockgrößen 10, 100, 1000 und 10000 getestet. Für die lokale Sortierung gelten diese Parameter natürlich nicht, hierbei wurde nur die Sortierung mittels \texttt{Colletions.sort()} ausgeführt. Als Daten die sortiert werden sollen wurden Goethes Faust I und II ausgewählt, die dem Projekt Gutenberg als Textdatei entnommen wurden. Die Testdatei hat dabei eine Dateigröße von 556 Kilobyte und wird vom Server vor der Verteilung an jedem Whitespace aufgetrennt. Dabei entstehen 81333 einzelne Strings, die dann Sortiert wurden.

\subsection{Auswertung}
Zur weiteren Referenz werden zunächst einmal die Messerte für das lokale Sortieren gegeben. 
Die folgende Messerte sind dabei angegeben:
\begin{itemize}
  \item Blockgröße: die verwende Blockgröße, d.h. wie viele Blöcke beim Iterieren über die sortierten Daten auf einmal vom Client zum Server übertragen werden.
  \item \# Clients: wie viele Clients am Sortieren beteiligt waren
  \item $t_{add}$: Wie lange der Server für das Einlesen der Daten und das Einfügen in eine lokale, unsortierte Liste benötigt hat.
  \item $t_{distribute}$: Wie lange die der Server zum Aufteilen und Verteilen der unsortierten Daten an die Clients benötigt hat. Die Clients beginnen unmittelbar nach dem Übertragen der Daten mit der Sortierung.
  \item $t_{iter}$: Wie lange der Server für der Iterieren über die sortierten Daten benötigt hat. Dies umfasst dabei auch die Kommunikationskosten - hier wirkt sich also die Blockgröße unmittelbar aus.
  \item  $t_{total}$: Die gesamte Ausführungszeit. Dies beinhaltet alle anderen gemessene Zeiten plus den benötigten Verwaltungsoverhead.  
\end{itemize}

Zunächst werden die Messwerte für das loakle Sortieren gegeben. Beim lokalen Sortieren wurden lediglich die Werte für das einfügen der Daten in einer lokale, unsortierte Liste ($t_{add}$), das Iterieren über die sortierten Ergebnisse ($t_{iter}$) und die Gesamtzeit gemessen, da die restlichen Messgrößen hierbei keine Rolle spielen. Auf die Ergebnisse wird an dieser Stelle nicht eingegangen, dies wird an späterer Stelle, im Zusammenhang mit den anderen Sortierverfahren erledigt. 
\begin{table}[htp]
\begin{tabularx}{\textwidth}{ |X|X|X|X|X|X| }
\hline
Blockgröße & \# Clients & $t_{add}$ (ms) & $t_{distribute}$ (ms) & $t_{iter}$ (ms) & $t_{total}$ (ms) \\
\hline
0 & 0 & 66 & 0 & 4 & 307 \\
\hline
\end{tabularx}
\caption{Ergenisdaten: Lokales sortieren (mittels \texttt{Collections.sort(\ldots)})}
\end{table}

\subsubsection{Verteiltes \textit{merge sort}}
\begin{table}[htp]
\begin{tabularx}{\textwidth}{ |X|X|X|X|X|X| }
\hline
Blockgröße & \# Clients & $t_{add}$ (ms) & $t_{distribute}$ (ms) & $t_{iter}$ (ms) & $t_{total}$ (ms) \\
\hline
10 & 2 & 104 & 533 & 8960 & 10908 \\
100 & 2 & 103 & 353 & 1489 & 2850 \\
1000 & 2 & 103 & 347 & 721 & 2080 \\
10000 & 2 & 102 & 338 & 559 & 1904 \\
\hline
10 & 4 & 103 & 467 & 11469 & 15145 \\
100 & 4 & 103 & 365 & 2050 & 3423 \\
1000 & 4 & 101 & 394 & 957 & 2557 \\
10000 & 4 & 103 & 337 & 756 & 2101 \\
\hline
10 & 8 & 99 & 1230 & 19300 & 23840 \\
100 & 8 & 99 & 523 & 2898 & 5126 \\
1000 & 8 & 112 & 619 & 1854 & 3924 \\
10000 & 8 & 108 & 552 & 964 & 2961 \\
\hline
10 & 16 & 105 & 854 & 25589 & 33684 \\
100 & 16 & 109 & 791 & 3982 & 11406 \\
1000 & 16 & 98 & 1310 & 2274 & 10494 \\
10000 & 16 & 108 & 838 & 1177 & 8578 \\
\hline
\end{tabularx}
\caption{Ergenisdaten: Verteiltes \textit{merge sort}}
\end{table}

\subsubsection{Verteiltes \textit{distribution sort}}
\begin{table}[htp]
\begin{tabularx}{\textwidth}{ |X|X|X|X|X|X| }
\hline
Blockgröße & \# Clients & $t_{add}$ (ms) & $t_{distribute}$ (ms) & $t_{iter}$ (ms) & $t_{total}$ (ms) \\
\hline
10 & 2 & 102 & 501 & 4844 & 7792 \\
100 & 2 & 103 & 573 & 1514 & 4506 \\
1000 & 2 & 100 & 468 & 556 & 3438 \\
10000 & 2 & 116 & 527 & 665 & 3614 \\
\hline
10 & 4 & 99 & 443 & 6873 & 9822 \\ 
100 & 4 & 109 & 516 & 1831 & 4662 \\ 
1000 & 4 & 122 & 352 & 483 & 3278 \\ 
10000 & 4 & 112 & 501 & 597 & 3415 \\
\hline
10 & 8 & 99 & 591 & 12638 & 15737 \\
100 & 8 & 117 & 451 & 1676 & 4658 \\
1000 & 8 & 111 & 577 & 985 & 3980 \\
10000 & 8 & 102 & 706 & 742 & 4190 \\
\hline
10 & 16 & 107 & 611 & 15080 & 18305 \\
100 & 16 & 110 & 867 & 2547 & 5938 \\
1000 & 16 & 103 & 752 & 861 & 4314 \\
10000 & 16 & 109 & 864 & 760 & 4351 \\
\hline
\end{tabularx}
\caption{Ergenisdaten : Verteiltes \textit{distribution sort}}
\end{table}



\end{document}

